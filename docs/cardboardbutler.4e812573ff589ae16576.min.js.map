{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./index.tsx","webpack:///./components/App.tsx","webpack:///./services/BggGameService.ts","webpack:///./components/CollectionPage.tsx","webpack:///./services/GamesFilterAndSorter.ts","webpack:///./services/BggGameLoader.ts","webpack:///./components/ValidatingUserInput.tsx","webpack:///./styles/App.css?f1c1","webpack:///./styles/App.css"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","rootEl","document","getElementById","render","AppContainer","WelcomePage","userValidator","onNameSelect","showWarning","className","Header","as","Message","MemoizedWelcomePage","React","memo","initialState","names","games","loadingInfo","showingCollection","showBackoff","superProps","collectionMerger","CollectionMerger","handleHashChange","bggService","bggServce","loader","onGamesUpdate","_ismounted","setState","onLoadUpdate","loadinfo","state","addEventListener","componentDidMount","this","hashValue","location","hash","substr","indexOf","usernames","substring","split","componentWillUnmount","removeEventListener","getBggService","props","newNames","console","log","join","loadCollections","then","loadExtendedInfo","loadPlays","getUserInfo","res","isValid","error","warn","allGoodAgain","loadingCollections","filter","li","type","map","username","isLoadingCollections","loadingGames","loadingPlays","progressStyle","position","borderRadius","bottom","height","left","right","padding","backgroundColor","Dimmer","active","inverted","Loader","content","currentUsers","style","inline","Progress","indicating","total","progress","lp","Component","fetchService","fetch","getUserCollection","fetchCollectionXml","xmlResult","undefined","jsObj","convert","xml2js","elements","allItems","item","valueOf","attributeName","getTagValue","playStats","getPlayStatsFromCollection","yearAsString","yearAsNumber","parseInt","gameId","attributes","objectid","assign","id","averagerating","getAverageRating","thumbnailUrl","yearPublished","imageUrl","families","getFamilies","userRating","getUserRating","fetchUserInfoXml","xml","getGamesInfo","ids","fetchGamesXml","elementToExtendedInfo","getPlays","getPlaysPage","firstPage","plays","totalPlays","numberOfPagesMissing","Math","ceil","missingPagesPromises","Array","fill","_","Promise","all","missingPagesResults","missingPagesPlays","reduce","prev","cur","concat","pageNumber","fetchPlaysXml","mainPlayElement","itemElements","toString","elementToPlayInfo","mainElement","date","Date","playId","quantity","mainElements","suggesteNumberOfPlayersMap","find","e","numOfPlayersString","numplayers","numberOfPlayers","Infinity","getNumberOfVotes","resultType","best","recommended","notRecommended","snp","getLinkValues","typeName","description","text","trim","weight","parseFloat","mechanics","categories","suggestedNumberOfPlayers","getFetch","stringValue","getRatingElement","getStatsElement","attr","parseAsInt","minPlayers","numberOwned","maxPlayers","minPlaytime","maxPlaytime","playingTime","ratingString","rating","getRanks","element","friendlyName","friendlyname","bayesaverage","tags","tagName","tagElement","url","buildCollectionUrl","fetchXml","buildGameUrls","buildPlaysUrl","tryFetch","urlToFetch","credentials","status","retryLater","backoff","Error","proxyUrl","encodeURIComponent","buildUserUrl","baseUrl","BggGameService","ratingNames","reverse","weightName","getWeightInfo","gameInfo","weightIndex","round","max","toLowerCase","generateDescription","getRatingDescription","family","getFamilyDescription","players","getPlayerInfoString","playtime","getTimeInfoString","firstString","getAOrAn","hasWeight","isVowel","input","charAt","sort","a","b","endsWith","ratingValue","ratingIndex","ratingInfo","playerInfo","timeInfo","mintime","maxtime","DescriptionGenerator","playercountOptions","playercount","filterBarInitialState","filterOptions","getSortOptionFromIndex","getSortOptionFromIndexSingle","getDropdownValues","getSortOptions","getOptions","minimum","maximum","options","sortOption","allowMultiSelect","isArray","iWe","sortingOptions","sortoption","singlePreferenceOption","multiPreferenceOption","onTimeChange","timerIndex","option","combineState","onPlayerCountChange","playerCountIndex","playerCount","so","onSortChange","sortOptionIndex","currentOption","newFilter","onFilterChange","joinWithAndEnd","strings","newStrings","last","pop","findIndex","oneUser","amAre","values","timeOptions","Container","fluid","href","Dropdown","placeholder","closeOnChange","onChange","_e","multiple","FilterBar","gameDescription","size","owners","Item","Image","src","Content","verticalAlign","target","Meta","Description","Extra","PureComponent","GameListItem","Card","wrapped","ui","extra","pickAGameInitialState","pickedGame","gamesAlreadyShown","pickARandomGame","close","gamesToPickFrom","gameToPossiblyPickFrom","every","alreadyShownGame","randomIndex","randomInteger","min","from","to","floor","random","onClick","Segment","Group","Button","color","stopPropagation","Icon","basic","game","centered","GameCardItem","icon","textAlign","circular","Divider","List","horizontal","hidden","onSetViewType","viewType","filteredGames","GamesFilterAndSorter","filterAndSort","noGames","top","bordered","NoGamesFound","PickAGameForMe","CollectionList","CollectionGrid","Footer","memoize","collection","averageRatingSorter","BggRatingSorter","weightHeavySort","aValue","HeavySorter","weightLightSort","LightSorter","innerSorters","mutableCollection","multiScoreMap","sorter","index","keys","forEach","combinedComparator","createCompareWithMap","indexMap","score","MultiSorter","nameSorter","localeCompare","NameSorter","oldYearSorter","getSafePlayCount","OldSorter","recentlySoter","getSafeLastPlayed","lastPlayed","getTime","PlayedALotSorter","PlayedLongAgoSorter","PlayedNotALotSorter","RecentlyPlayedSorter","getSuggestedComparatorComparator","getSuggestePlayerScore","votes","SuggestedPlayersSorter","userRatingSorter","aRating","getAverageUserRating","scoreMap","userNamesWithRatings","UserRatingSorter","newYearSorter","YoungSorter","sortMap","alphabetic","bggrating","new","old","userrating","getSorterInner","getSorter","sortCollection","sortCollectionInner","GameSorter","filterCollectionInner","filterCollection","filterOnTime","filterOnPlayerCount","GameFilterer","filterer","filterAndSortInner","collectionCopy","filtered","getMergedCollection","getMergedCollectionInner","collectionsMap","cache","sharedUserRatingSet","Set","currentGame","alreadyKnownGame","has","add","merger","useCache","collectionMap","extraInfoMap","playsMap","currentNames","eventHandlers","loadingEventHandlers","concurrentRequestLimit","service","loadCollectionWithRetry","getAllGamesPlus","getAllGamesPlusPure","informCollectionUpdateHandlers","getAllGamesPlusPureMemo","getShownGamesMapMemo","getShownGamesMap","getGamesWithExtraInfoMemo","getGamesWithExtraInfo","getGamesWithPlayInfoMemo","getGamesWithPlayInfo","loadCollectionsFromCache","loadExtraInfo","setStorageVersion","storeCollections","allGames","allUnknownGames","isLoading","gameinfo","chunks","chunk","unknownGames","loadGamesWithRetry","extraInfos","extraInfo","storeExtraInfo","chunkSize","chunked_arr","copied","numOfChild","localStorage","setItem","JSON","stringify","getItem","removeItem","parse","known","ag","allPlaysOfGame","usersPlays","usersPlay","playedBy","lastPlayInMinutes","timePlayedInMinutes","timePlayedMinutes","shownGamesMap","allGamesPlus","handler","informLoadingHandlers","getLoadingInfo","loadPlaysWithRetry","playerPlays","retryTime","resolver","setTimeout","g","loadingIndex","retryInfo","extendeds","onInputChange","getNamesToShow","onAddClick","onDeleteClick","onUseClick","onNameChange","bggNames","clone","newNamesToShow","namesToShow","showDelete","validNames","loadingNames","invalidNames","hasEnoughNames","forwardButtonText","canUseNames","buttonDisabled","isInvalid","isLast","inputName","isValidLabel","removeButton","cursor","Input","labelPosition","label","loading","autoFocus","disabled","SelectUserInput","shownNames","onNamesChange","doesNameNeedValidation","isNameShown","setNameLoading","setNameValidity","loadingName","namesToValidate","marginTop","api","default","locals","___CSS_LOADER_API_IMPORT___"],"mappings":"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","file":"cardboardbutler.4e812573ff589ae16576.min.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([290,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as React from \"react\";\nimport { render } from \"react-dom\";\nimport { AppContainer } from \"react-hot-loader\";\nimport App from \"./components/App\";\nimport \"./styles/App.css\";\n\nconst rootEl = document.getElementById(\"content\");\n\nrender(\n    <AppContainer>\n        <App />\n    </AppContainer>,\n    rootEl\n);\n\n// Hot Module Replacement API\ndeclare let module: { hot: any };\n\nif (module.hot) {\n    module.hot.accept(\"./components/App\", () => {\n        const NewApp = require(\"./components/App\").default;\n\n        render(\n            <AppContainer>\n                <NewApp />\n            </AppContainer>,\n            rootEl\n        );\n    });\n}\n","import * as React from \"react\";\nimport BggGameService from \"../services/BggGameService\";\nimport { GameInfoPlus } from \"../types\";\nimport CollectionPage from \"./CollectionPage\";\nimport BggGameLoader, { LoadingInfo, PlaysLoadingInfo, CollectionMerger } from \"../services/BggGameLoader\";\nimport { Dimmer, Loader, Progress, Header, Message } from \"semantic-ui-react\";\nimport ValidatingUserInput from \"./ValidatingUserInput\";\n\n// --- WelcomePage Component ---\n\ninterface WelcomePageProps {\n    onNameSelect: (names: string[]) => any;\n    userValidator: (name: string) => Promise<boolean>;\n    showWarning?: boolean;\n}\n\nconst WelcomePage: React.FC<WelcomePageProps> = ({ userValidator, onNameSelect, showWarning }) => {\n    return (\n        <div className=\"ui middle aligned center aligned grid givenames\" data-testid=\"WelcomePage\">\n            <div className=\"column\">\n                <div>\n                    <Header as=\"h3\">\n                        <span>Good day, how can I help you today?</span>\n                    </Header>\n                </div>\n                <div className=\"ui large form\" >\n                    <div className=\"ui\">\n                        <ValidatingUserInput\n                            userValidator={userValidator}\n                            onNameSelect={onNameSelect}\n                        />\n                    </div>\n                </div>\n                {showWarning && <Message>\n                    <Message.Header>BGG is taking a breather</Message.Header>\n                    <p>\n                        Boardgame Geek has a limit on how many requests I can make.\n                        Unfortunatly the limit has been hit for a while, so try agian in a couple of minutes (or 10).\n                    </p>\n                </Message>}\n            </div>\n        </div>\n    );\n};\n\nconst MemoizedWelcomePage = React.memo(WelcomePage);\n\n// --- App Component ---\n\nexport interface AppProps {\n    bggServce?: BggGameService;\n}\n\n\nexport interface AppState {\n    names: string[];\n    games: GameInfoPlus[];\n    loadingInfo: LoadingInfo[];\n    showingCollection: boolean;\n    showBackoff: boolean;\n}\n\nconst initialState: AppState = { names: [], games: [], loadingInfo: [], showingCollection: false, showBackoff: false };\n\n\nexport default class App extends React.Component<AppProps, AppState> {\n\n    private collectionMerger: CollectionMerger;\n    private readonly loader: BggGameLoader;\n\n    constructor(superProps: Readonly<AppProps>) {\n        super(superProps);\n        this.collectionMerger = new CollectionMerger();\n\n        this.onNameSelect = this.onNameSelect.bind(this);\n        this.userValidator = this.userValidator.bind(this);\n        this.handleHashChange = this.handleHashChange.bind(this);\n        const bggService = superProps.bggServce || new BggGameService();\n        this.loader = new BggGameLoader(bggService, this.collectionMerger, true);\n        this.loader.onGamesUpdate((games) => {\n            if (this._ismounted) {\n                this.setState({ games: games, showingCollection: true });\n            }\n        });\n        this.loader.onLoadUpdate((loadinfo) => {\n            if (this._ismounted) {\n                this.setState({ loadingInfo: loadinfo });\n            }\n        });\n        this.state = initialState;\n        window.addEventListener(\"hashchange\", this.handleHashChange, false);\n    }\n\n    private _ismounted: boolean;\n\n\n    componentDidMount() {\n        this._ismounted = true;\n        this.handleHashChange();\n    }\n\n    handleHashChange() {\n        const hashValue = window.location.hash.substr(0);\n        if (hashValue && hashValue !== \"\" && hashValue.indexOf(\"usernames=\") > -1) {\n            const usernames = hashValue.substring(\"usernames=\".length + 1).split(\",\");\n            this.onNameSelect(usernames);\n        } else {\n            this.setState(initialState);\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"hashchange\", this.handleHashChange, false);\n        this._ismounted = false;\n    }\n\n    getBggService() {\n        return this.props.bggServce || new BggGameService();\n    }\n\n\n    onNameSelect(newNames: string[]) {\n        console.log(\"[DEBUG] App: onNameSelect called with\", newNames);\n        if (newNames.join(\",\") !== this.state.names.join(\",\")) {\n            this.setState({\n                names: newNames\n            });\n            window.location.hash = \"usernames=\" + newNames.join(\",\");\n            if (this._ismounted) {\n                console.log(\"[DEBUG] App: Loading collections for\", newNames);\n                this.loader.loadCollections(newNames).then(() => {\n                    this.loader.loadExtendedInfo().then(() => {\n                        this.loader.loadPlays();\n                    });\n                });\n            }\n        } else {\n            console.log(\"[DEBUG] App: Names unchanged, skipping load\");\n        }\n    }\n\n\n    async userValidator(name: string) {\n        console.log(`[DEBUG] App: userValidator invoked for '${name}'`);\n        const res = await this.getBggService().getUserInfo(name);\n        console.log(`[DEBUG] App: userValidator result for '${name}':`, res);\n        \n        const beingToldToBackOff = res.isValid === \"unknown\" && res.error === \"backoff\";\n        if (beingToldToBackOff) {\n            console.warn(\"[DEBUG] App: Backoff triggered\");\n            this.setState({ showBackoff: true });\n            return false;\n        } else {\n            const allGoodAgain = res.isValid === true;\n            if (allGoodAgain) {\n                this.setState({ showBackoff: false });\n            }\n            return allGoodAgain;\n        }\n    }\n\n    render() {\n        const { loadingInfo = [], games, showingCollection, names, showBackoff } = this.state;\n        const loadingCollections = loadingInfo.filter((li) => li.type === \"collection\").map((c) => c.type === \"collection\" ? c.username : \"\");\n        const isLoadingCollections = loadingCollections.length > 0;\n        const loadingGames = loadingInfo.filter((li) => li.type === \"game\");\n        const loadingPlays = loadingInfo.filter((li) => li.type === \"plays\") as PlaysLoadingInfo[];\n        const progressStyle: React.CSSProperties = { position: \"fixed\", borderRadius: 30, bottom: 0, height: 120, left: \"20%\", right: \"20%\", padding: 40, backgroundColor: \"white\" };\n        return (\n            <span >\n                {!showingCollection && !isLoadingCollections && <MemoizedWelcomePage onNameSelect={this.onNameSelect} userValidator={this.userValidator} showWarning={showBackoff} />}\n                {isLoadingCollections && games.length === 0 && <Dimmer active inverted>\n                    <Loader inverted content={\"Finding games for \" + loadingCollections.join(\", \")} />\n                </Dimmer>\n                }\n\n                {showingCollection && (games.length > 0 || !isLoadingCollections) && <CollectionPage currentUsers={this.state.names} games={games} />}\n                {isLoadingCollections && games.length > 0 &&\n                    <div style={progressStyle}>\n                        <Loader active inline=\"centered\" content={\"Finding games for \" + loadingCollections.join(\", \")} />\n                    </div>\n                }\n                {games.length > 0 && loadingGames.length > 0 &&\n                    < div style={progressStyle}>\n                        <Progress indicating value={games.length - loadingGames.length} total={games.length} progress=\"ratio\">\n                            Getting more game info\n                    </Progress>\n                    </div>\n                }\n\n                {games.length > 0 && loadingPlays.length > 0 &&\n                    < div style={progressStyle}>\n                        <Progress indicating value={names.length - loadingPlays.length} total={names.length} progress=\"ratio\">\n                            Finding plays for {loadingPlays.map((lp) => lp.username).join(\", \")}\n                        </Progress>\n                    </div>\n                }\n\n            </span>\n        );\n    }\n}","import { FetchService } from \"../types\";\nimport * as convert from \"xml-js\";\nimport { GameInfo, ExtendedGameInfo, SuggestedNumberOfPlayersMap, PlayInfo } from \"../types\";\nimport { UserInfo } from \"../types\";\n\n\nexport type BggRetryResult = { retryLater: boolean, backoff?: boolean, error?: Error };\n/**\n * A service that can wraps the BGG Api.\n * It does not cache, or handle retries, it simple transform the bgg api into xml\n * Be adviced: This uses a CORS proxy, to get around the BGG API not providing CORS information.\n */\nclass BggGameService {\n\n    private fetchService: FetchService;\n\n    /**\n     * Construct a new bgg game service.\n     * @param fetchService the service to use when trying to fetch information from bgg. If none is given the browser global fetch will be used.\n     */\n    constructor(fetchService?: FetchService) {\n        this.fetchService = fetchService || fetch;\n    }\n\n    /**\n     * Gets a collection of the owned games from a user.\n     * @param username username of the user whose collection to get.\n     * @returns Either a list of game infromation, or a bgg retry result, if there is an error or bgg needed time to generate the list.\n     */\n    async getUserCollection(username: string): Promise<BggRetryResult | GameInfo[]> {\n        const xmlResult = await this.fetchCollectionXml(username);\n        if (typeof xmlResult !== \"string\") {\n            return xmlResult;\n        }\n        const jsObj = convert.xml2js(xmlResult);\n        if (jsObj.elements === undefined) {\n            return [];\n        }\n        const allItems: convert.Element[] = jsObj.elements[0].elements;\n        if (allItems === undefined) {\n            return [];\n        }\n        return allItems.map((item: convert.Element) => {\n            const elements = item.elements;\n            const valueOf = (attributeName: string) => this.getTagValue(elements, attributeName);\n            const playStats = this.getPlayStatsFromCollection(elements);\n            const yearAsString: string | undefined = valueOf(\"yearpublished\");\n            const yearAsNumber = yearAsString === undefined ? undefined : parseInt(yearAsString, 10);\n            const gameId = parseInt(item.attributes.objectid as string);\n            const game: GameInfo = Object.assign({\n                id: gameId,\n                averagerating: this.getAverageRating(elements),\n                name: valueOf(\"name\"),\n                thumbnailUrl: valueOf(\"thumbnail\"),\n                yearPublished: yearAsNumber,\n                imageUrl: valueOf(\"image\"),\n                families: this.getFamilies(elements),\n                userRating: this.getUserRating(username, elements)\n            }, playStats);\n            return game;\n        });\n    }\n\n    /**\n     * Get user information about a given useranme.\n     * If a username is given that does not excist then \"isValid:true\" will be returned.\n     * If the call to bgg fails, then \"isValid:unknown\" is returend, as the service cannot know if the name is valid.\n     * @param username the username to get information for\n     */\n    async getUserInfo(username: string): Promise<UserInfo> {\n        console.log(`[DEBUG] BggGameService: getUserInfo called for ${username}`);\n        const xml = await this.fetchUserInfoXml(username);\n        if (typeof xml !== \"string\") {\n            console.error(`[DEBUG] BggGameService: getUserInfo failed for ${username}`, xml);\n            return {\n                isValid: \"unknown\",\n                error: xml.error\n            };\n        }\n        const jsObj = convert.xml2js(xml);\n        if (jsObj.elements) {\n            const attributes = jsObj.elements[0].attributes;\n            if (attributes) {\n                const id = attributes.id;\n                if (id !== \"\") {\n                    const name = attributes.name;\n                    return {\n                        isValid: true,\n                        username: name\n                    };\n                }\n            } else {\n                return {\n                    isValid: \"unknown\",\n                    error: \"Bgg is likely processing\"\n                };\n            }\n        }\n        return {\n            isValid: false\n        };\n    }\n\n\n    async getGamesInfo(ids: number[]): Promise<BggRetryResult | ExtendedGameInfo[]> {\n        const xml = await this.fetchGamesXml(ids);\n        if (typeof xml === \"string\") {\n            const jsObj = convert.xml2js(xml) as convert.Element;\n            const itemElements = jsObj.elements[0].elements;\n            return itemElements.map((this.elementToExtendedInfo));\n        } else {\n            return xml;\n        }\n    }\n\n\n\n    async getPlays(username: string): Promise<BggRetryResult | PlayInfo[]> {\n        const firstPage = await this.getPlaysPage(username);\n        if (\"plays\" in firstPage) {\n            const { plays, totalPlays } = firstPage;\n            const needMorePlays = firstPage.totalPlays > firstPage.plays.length;\n            if (needMorePlays) {\n                const numberOfPagesMissing = Math.ceil(totalPlays / plays.length) - 1;\n                const missingPagesPromises = new Array(numberOfPagesMissing).fill(0).map((_, i) => this.getPlaysPage(username, i + 2)); // start at index 2, we already have page 1\n                const missingPagesResults = await Promise.all(missingPagesPromises);\n                const missingPagesPlays = missingPagesResults.reduce((prev, cur) => (\"plays\" in cur) ? prev.concat(cur.plays) : prev, [] as PlayInfo[]);\n                return [...plays, ...missingPagesPlays];\n            } else {\n                return plays;\n            }\n        } else {\n            return firstPage;\n        }\n\n    }\n\n    async getPlaysPage(username: string, pageNumber = 1) {\n        const xml = await this.fetchPlaysXml(username, pageNumber);\n        if (typeof xml === \"string\") {\n            const jsObj = convert.xml2js(xml) as convert.Element;\n            const mainPlayElement = jsObj.elements[0];\n            if (mainPlayElement.elements === undefined) {\n                return {\n                    totalPlays: 0,\n                    pageNumber: pageNumber,\n                    plays: []\n                };\n            }\n            const itemElements = mainPlayElement.elements;\n            const totalPlays = parseInt(mainPlayElement.attributes[\"total\"].toString());\n            return {\n                totalPlays: totalPlays,\n                pageNumber: pageNumber,\n                plays: itemElements.map(this.elementToPlayInfo)\n            };\n        } else {\n            return xml;\n        }\n    }\n\n    private elementToPlayInfo(mainElement: convert.Element): PlayInfo {\n\n        return {\n            date: new Date(mainElement.attributes[\"date\"]),\n            gameId: parseInt(mainElement.elements[0].attributes[\"objectid\"].toString()),\n            length: parseInt(mainElement.attributes[\"length\"].toString()),\n            playId: parseInt(mainElement.attributes[\"id\"].toString()),\n            quantity: parseInt(mainElement.attributes[\"quantity\"].toString()),\n        };\n\n    }\n\n\n\n    private elementToExtendedInfo(mainElement: convert.Element): ExtendedGameInfo {\n        const mainElements = mainElement.elements;\n        const suggestedplayersElement = mainElements.find((e) => e.name === \"poll\" && e.attributes.name === \"suggested_numplayers\");\n        const suggestedNumberOfPlayersArray = suggestedplayersElement.elements.map((e) => {\n            const numOfPlayersString = e.attributes.numplayers.toString();\n            const numberOfPlayers = numOfPlayersString.indexOf(\"+\") > -1 ? Infinity : parseInt(numOfPlayersString, 10);\n            const getNumberOfVotes = (resultType: string) => parseInt(e.elements.find((e) => e.name === \"result\" && e.attributes[\"value\"].toString() === resultType).attributes.numvotes as string);\n            if (e.elements) {\n                const best = getNumberOfVotes(\"Best\");\n                const recommended = getNumberOfVotes(\"Recommended\");\n                const notRecommended = getNumberOfVotes(\"Not Recommended\");\n                return {\n                    numberOfPlayers: numberOfPlayers,\n                    best: best,\n                    recommended: recommended,\n                    notRecommended: notRecommended\n                };\n            }\n            return undefined;\n\n        });\n        const suggesteNumberOfPlayersMap: SuggestedNumberOfPlayersMap = suggestedNumberOfPlayersArray.filter((snp) => snp).reduce((p, c) => Object.assign(p, { [c.numberOfPlayers]: c }), {});\n        const getLinkValues = (typeName: string) => mainElements.filter((e) => e.name === \"link\" && e.attributes[\"type\"] === typeName).map((e) => e.attributes[\"value\"].toString());\n        return {\n            description: mainElements.find((e) => e.name === \"description\").elements[0].text.toString().trim(),\n            weight: parseFloat(mainElements.find((e) => e.name === \"statistics\").elements[0].elements.find((e) => e.name === \"averageweight\").attributes[\"value\"].toString().trim()),\n            mechanics: getLinkValues(\"boardgamemechanic\"),\n            categories: getLinkValues(\"boardgamecategory\"),\n            suggestedNumberOfPlayers: suggesteNumberOfPlayersMap\n        };\n    }\n\n\n    private getFetch() {\n        return this.fetchService;\n    }\n\n    private getAverageRating(elements: convert.Element[]) {\n        const stringValue = this.getRatingElement(elements).elements.find((t) => t.name === \"average\").attributes.value;\n        return parseFloat(stringValue.toString());\n    }\n\n    private getStatsElement(elements: convert.Element[]) {\n        return elements.find((t) => t.name === \"stats\");\n    }\n\n    private getRatingElement(elements: convert.Element[]) {\n        return this.getStatsElement(elements).elements[0];\n    }\n\n    private getPlayStatsFromCollection(elements: convert.Element[]) {\n        const stats = this.getStatsElement(elements);\n        const attr = stats.attributes;\n        const parseAsInt = (name: string) => attr[name] && parseInt(attr[name].toString());\n        return {\n            minPlayers: parseAsInt(\"minplayers\"),\n            numberOwned: parseAsInt(\"numowned\"),\n            maxPlayers: parseAsInt(\"maxplayers\"),\n            minPlaytime: parseAsInt(\"minplaytime\"),\n            maxPlaytime: parseAsInt(\"maxplaytime\"),\n            playingTime: parseAsInt(\"playingtime\")\n        };\n    }\n    private getUserRating(username: string, elements: convert.Element[]) {\n        const ratingElement = this.getRatingElement(elements);\n        const ratingString = ratingElement.attributes[\"value\"] as string;\n        const rating = (ratingString === \"N/A\" || ratingString === undefined) ? null : parseFloat(ratingString);\n        const result = {};\n        result[username] = rating;\n        return result;\n    }\n\n\n    private getFamilies(elements: convert.Element[]) {\n        const ranks = this.getRanks(elements);\n        return ranks.filter((r) => r.type === \"family\");\n    }\n\n\n    private getRanks(elements: convert.Element[]) {\n        const ratings = this.getRatingElement(elements);\n        const ranks = ratings.elements.find((t) => t.name === \"ranks\").elements;\n        return ranks.map((element) => {\n            const attributes = element.attributes;\n            return {\n                name: attributes.name.toString(),\n                friendlyName: attributes.friendlyname.toString(),\n                bayesaverage: parseFloat(attributes.bayesaverage.toString()),\n                value: parseInt(attributes.value.toString()),\n                type: attributes.type.toString()\n            };\n        });\n    }\n\n    private getTagValue(tags: convert.Element[], tagName: string) {\n        const tagElement = tags.find((t) => t.name === tagName);\n        if (!(tagElement && tagElement.elements)) {\n            return undefined;\n        }\n        return tagElement.elements[0].text.toString();\n    }\n\n    private async fetchCollectionXml(username: string) {\n        const url = this.buildCollectionUrl(username);\n        return this.fetchXml(url);\n    }\n\n\n    private async fetchGamesXml(ids: number[]) {\n        const url = this.buildGameUrls(ids);\n        return this.fetchXml(url);\n    }\n\n\n    private async fetchPlaysXml(username: string, pageNumber: number) {\n        const url = this.buildPlaysUrl(username, pageNumber);\n        return this.fetchXml(url);\n    }\n\n\n\n    private async fetchXml(url: string) {\n        const tryFetch = async (urlToFetch: string) => {\n            console.log(`[DEBUG] BggGameService: Attempting fetch: ${urlToFetch}`);\n            // Fix: Add credentials: 'omit' to prevent 401 Unauthorized caused by sending cookies to BGG\n            return this.getFetch()(urlToFetch, { credentials: 'omit' }).then(async (res) => {\n                console.log(`[DEBUG] BggGameService: Response status for ${urlToFetch}: ${res.status}`);\n                if (res.status === 200) {\n                    return res.text();\n                }\n                if (res.status === 429) {\n                    console.warn(`[DEBUG] BggGameService: 429 Rate Limit Hit for ${urlToFetch}`);\n                    return { retryLater: true, backoff: true };\n                }\n                else {\n                    throw new Error(`Status ${res.status}`);\n                }\n            });\n        };\n\n        try {\n            return await tryFetch(url);\n        } catch (e) {\n            console.warn(`[DEBUG] BggGameService: Direct fetch failed for ${url}, trying proxy. Error:`, e);\n            const proxyUrl = \"https://corsproxy.io/?url=\" + encodeURIComponent(url);\n            try {\n                return await tryFetch(proxyUrl);\n            } catch (proxyError) {\n                console.error(`[DEBUG] BggGameService: Proxy fetch failed for ${proxyUrl}`, proxyError);\n                return { retryLater: true, error: proxyError };\n            }\n        }\n    }\n\n\n    private async fetchUserInfoXml(username: string) {\n        const url = this.buildUserUrl(username);\n        const tryFetch = async (urlToFetch: string) => {\n            console.log(`[DEBUG] BggGameService: UserInfo fetch: ${urlToFetch}`);\n            // Fix: Add credentials: 'omit' here as well\n            return this.getFetch()(urlToFetch, { credentials: 'omit' }).then(async (res) => {\n                console.log(`[DEBUG] BggGameService: UserInfo Response status for ${urlToFetch}: ${res.status}`);\n                if (res.status === 200 || res.status === 202) {\n                    return await res.text();\n                }\n                if (res.status === 429) {\n                    console.warn(`[DEBUG] BggGameService: UserInfo 429 Rate Limit`);\n                    return { error: \"backoff\" };\n                }\n                throw new Error(`Status ${res.status}`);\n            });\n        };\n\n        try {\n            return await tryFetch(url);\n        } catch (e) {\n            console.warn(`[DEBUG] BggGameService: Direct UserInfo fetch failed for ${url}, trying proxy. Error:`, e);\n            const proxyUrl = \"https://corsproxy.io/?url=\" + encodeURIComponent(url);\n            try {\n                return await tryFetch(proxyUrl);\n            } catch (proxyError) {\n                console.error(`[DEBUG] BggGameService: Proxy UserInfo fetch failed for ${proxyUrl}`, proxyError);\n                return { error: proxyError };\n            }\n        }\n    }\n\n    private buildPlaysUrl(username: string, pageNumber: number) {\n        const baseUrl = `https://api.geekdo.com/xmlapi2/plays?username=${username}`;\n        return pageNumber > 1 ? (baseUrl + \"&page=\" + pageNumber) : baseUrl;\n    }\n\n    private buildGameUrls(ids: number[]) {\n        return `https://api.geekdo.com/xmlapi2/thing?id=${ids.join(\",\")}&stats=1`;\n    }\n\n    private buildCollectionUrl(username: string) {\n        return `https://api.geekdo.com/xmlapi2/collection?username=${username}&own=1&stats=1&excludesubtype=boardgameexpansion`;\n    }\n\n    private buildUserUrl(username: string) {\n        return `https://api.geekdo.com/xmlapi2/user?name=${username}`;\n    }\n\n\n}\n\n\n\nexport default BggGameService;\n","import * as React from \"react\";\nimport { Container, Header, Icon, Divider, List, Item, Card, Image, Button, Dimmer, Segment, Dropdown } from \"semantic-ui-react\";\nimport { FilterAndSortOptions, GameInfoPlus, GameInfo, ExtendedGameInfo, PlayTimeOption, PlayCountOption, SortOption } from \"../types\";\nimport { GamesFilterAndSorter } from \"../services/GamesFilterAndSorter\";\n\n// --- DescriptionGenerator ---\n\nconst ratingNames = [\n    \"Outstanding\",\n    \"Outstanding\",\n    \"Very good\",\n    \"Good\",\n    \"Ok\",\n    \"Mediocre\",\n    \"Not so good\",\n    \"Bad\",\n    \"Very bad\",\n    \"Awful\"\n].reverse();\n\nconst weightName = [\n    \"Very easy\",\n    \"Easy\",\n    \"Moderately difficult\",\n    \"Somewhat hard\",\n    \"Hard\",\n    \"Very Hard\"\n];\n\nconst vowel_list = \"aeiouAEIOU\";\n\n\n/**\n * Can generate a human readable describtion of a given game.\n */\nexport class DescriptionGenerator {\n\n    /**\n     * Given game information, generates a human readable description.\n     * @param gameInfo the game to generate a description for.\n     */\n    generateDescription(gameInfo: GameInfoPlus): string {\n        const rating = this.getRatingDescription(gameInfo.averagerating);\n        const family = this.getFamilyDescription(gameInfo);\n        const players = this.getPlayerInfoString(gameInfo);\n        const playtime = this.getTimeInfoString(gameInfo);\n        const aOrAn = this.getAOrAn(family);\n        let firstString = `${aOrAn} ${family} for ${players} in ${playtime}.`;\n\n        const hasWeight = (\"weight\" in gameInfo) && gameInfo.weight !== undefined;\n        if (hasWeight || gameInfo.averagerating !== undefined) {\n            firstString += ` Most people think it is `;\n        }\n        if (gameInfo.averagerating !== undefined) {\n            firstString += rating.toLowerCase();\n            if (!hasWeight) {\n                firstString += \".\";\n            }\n        }\n        if (hasWeight && gameInfo.averagerating !== undefined) {\n            firstString = firstString + \" and \";\n        }\n        if (hasWeight) {\n            const weight = this.getWeightInfo(gameInfo as ExtendedGameInfo);\n            firstString += weight + \" to learn.\";\n        }\n        return firstString;\n    }\n\n    private isVowel(input: string) {\n        return vowel_list.indexOf(input) > -1;\n    }\n\n    private getAOrAn(input: string) {\n        if (this.isVowel(input.charAt(0))) {\n            return \"An\";\n        }\n        return \"A\";\n    }\n\n    private getFamilyDescription(gameInfo: GameInfoPlus) {\n        if (gameInfo.families === undefined || gameInfo.families.length === 0) {\n            return \"boardgame\";\n        }\n        const bestFamily = gameInfo.families.sort((a, b) => a.value - b.value)[0];\n        let name = bestFamily.friendlyName.toLowerCase();\n        if (name.indexOf(\" rank\") > -1) {\n            name = name.substring(0, name.indexOf(\" rank\"));\n        }\n        if (!name.endsWith(\"game\")) {\n            name += \" game\";\n        }\n        return name;\n    }\n\n    private getRatingDescription(ratingValue?: number) {\n        const ratingIndex = Math.round(ratingValue);\n        const ratingInfo = ratingNames[ratingIndex - 1];\n        return ratingInfo ? ratingInfo : \"\";\n    }\n\n    private getPlayerInfoString(gameInfo: GameInfoPlus) {\n        let playerInfo = \"\";\n        const { minPlayers, maxPlayers } = gameInfo;\n\n        if (minPlayers === maxPlayers) {\n            playerInfo += maxPlayers + \" player\";\n        } else {\n            playerInfo += minPlayers + \" to \" + maxPlayers + \" player\";\n        }\n        if (maxPlayers > 1) {\n            playerInfo += \"s\";\n        }\n        return playerInfo;\n    }\n\n    private getTimeInfoString(gameInfo: GameInfo) {\n        let timeInfo = \"\";\n\n        const mintime = gameInfo.minPlaytime;\n        const maxtime = gameInfo.maxPlaytime;\n\n        if (mintime === maxtime) {\n            timeInfo += maxtime + \" minute\";\n        } else if (maxtime < mintime) {\n            timeInfo += mintime + \" minute\";\n        } else {\n            timeInfo += mintime + \" - \" + maxtime + \" minute\";\n        }\n        if (maxtime > 1) {\n            timeInfo += \"s\";\n        }\n        return timeInfo;\n    }\n\n    private getWeightInfo = (gameInfo: ExtendedGameInfo) => {\n        const weight = gameInfo.weight;\n        const weightIndex = Math.round((weight - 1) / 5 * 6);\n        return weightName[Math.max(weightIndex, 0)].toLowerCase();\n    }\n}\n\n// --- FilterBar ---\n\nexport interface FilterBarProps {\n    onFilterChange?: (options: FilterAndSortOptions) => any;\n    currentUsers?: string[];\n}\ninterface FilterBarState {\n    filterOptions: FilterAndSortOptions;\n}\n\ninterface TimerOptions {\n    text: string;\n    value: number;\n    playtime?: PlayTimeOption;\n}\n\ninterface PlayerCountOptions {\n    text: string;\n    value: number;\n    playercount?: PlayCountOption;\n}\n\nexport const playercountOptions: PlayerCountOptions[] = [\n    { text: \"any number of players\", value: 0, playercount: null },\n    { text: \"1 person\", value: 1, playercount: 1 },\n];\n\nfor (let i = 2; i <= 10; i++) {\n    playercountOptions.push({ text: i + \" people\", value: i, playercount: i });\n}\n\ninterface SortingOptions {\n    text: string;\n    value: number;\n    sortoption?: SortOption;\n    [\"data-testid\"]?: string;\n}\n\nconst filterBarInitialState: FilterBarState = {\n    filterOptions: {\n    }\n};\n\nexport class FilterBar extends React.Component<FilterBarProps, FilterBarState> {\n    constructor(props: FilterBarProps) {\n        super(props);\n        this.state = filterBarInitialState;\n        this.getSortOptionFromIndex = this.getSortOptionFromIndex.bind(this);\n        this.getSortOptionFromIndexSingle = this.getSortOptionFromIndexSingle.bind(this);\n        this.getDropdownValues = this.getDropdownValues.bind(this);\n        this.getSortOptions = this.getSortOptions.bind(this);\n    }\n\n    getOptions() {\n        const timeOptions: TimerOptions[] = [\n            { text: \"any time\", value: 0, playtime: null },\n            { text: \"30 minutes or less\", value: 1, playtime: { minimum: 0, maximum: 30 } },\n            { text: \"1 hour or less\", value: 2, playtime: { maximum: 60 } },\n            { text: \"2 hours or less\", value: 3, playtime: { maximum: 120 } },\n            { text: \"3 hours or less\", value: 4, playtime: { maximum: 180 } },\n            { text: \"20-60 minutes\", value: 5, playtime: { minimum: 20, maximum: 60 } },\n            { text: \"1-2 hours\", value: 6, playtime: { minimum: 60, maximum: 120 } },\n            { text: \"2-4 hours\", value: 7, playtime: { minimum: 120, maximum: 240 } },\n            { text: \"4 or more hours\", value: 8, playtime: { minimum: 240, maximum: 9999999 } },\n\n        ];\n        return timeOptions;\n    }\n\n    getSortOptions() {\n        const options = this.state.filterOptions.sortOption;\n        const allowMultiSelect = Array.isArray(options);\n        const { currentUsers = [\"Unknown\"] } = this.props;\n        const oneUser = currentUsers.length <= 1;\n        const iWe = oneUser ? \"I\" : \"we\";\n\n        const sortingOptions: SortingOptions[] = [\n            { text: \"are highly rated\", value: 0, sortoption: \"bggrating\" },\n            { text: \"are alphabetic\", value: 1, sortoption: \"alphabetic\" },\n            { text: \"are new\", value: 2, sortoption: \"new\", [\"data-testid\"]: \"sortByNew\" },\n            { text: \"are old\", value: 3, sortoption: \"old\" },\n            { text: iWe + \" rate highly\", value: 4, sortoption: \"userrating\" },\n            { text: \"are easy to learn\", value: 5, sortoption: \"weight-light\" },\n            { text: \"are complex\", value: 6, sortoption: \"weight-heavy\" },\n            { text: \"are best with this number of players\", value: 7, [\"data-testid\"]: \"suggestedPlayers\" },\n            { text: iWe + \" played recently\", value: 8, sortoption: \"playedRecently\" },\n            { text: iWe + \" haven't played in a while\", value: 9, sortoption: \"playedLongAgo\" },\n            { text: iWe + \" have played a lot\", value: 10, sortoption: \"playedALot\" },\n            { text: iWe + \" have not played a lot\", value: 11, sortoption: \"playedNotALot\" },\n        ];\n        const singlePreferenceOption: SortingOptions = { text: iWe + \" only have one preference\", value: 12, [\"data-testid\"]: \"SortBySingleOption\" };\n        const multiPreferenceOption: SortingOptions = { text: iWe + \" have multiple preferences\", value: 12, [\"data-testid\"]: \"SortByMultipleOption\" };\n        return [...sortingOptions, allowMultiSelect ? singlePreferenceOption : multiPreferenceOption];\n    }\n\n    onTimeChange(timerIndex: number) {\n        const option = this.getOptions()[timerIndex].playtime;\n        this.combineState({ playtime: option });\n    }\n\n    onPlayerCountChange(playerCountIndex: number) {\n        const option = playercountOptions[playerCountIndex].playercount;\n        const sortOption = this.state.filterOptions.sortOption;\n        if (Array.isArray(sortOption)) {\n            this.combineState({ playerCount: option, sortOption: sortOption.map((so) => typeof so === \"object\" ? Object.assign({}, this.state.filterOptions.sortOption, { numberOfPlayers: option }) : so) as any });\n        } else if (typeof sortOption === \"object\") {\n            this.combineState({ playerCount: option, sortOption: Object.assign({}, this.state.filterOptions.sortOption, { numberOfPlayers: option }) });\n        } else {\n            this.combineState({ playerCount: option });\n        }\n    }\n\n    onSortChange(sortOptionIndex: number | number[]) {\n        const currentOption = this.state.filterOptions.sortOption;\n        const clickedSwitchState = sortOptionIndex === 12 || (Array.isArray(sortOptionIndex) && sortOptionIndex.indexOf(12) > -1);\n        if (clickedSwitchState) {\n            if (Array.isArray(currentOption)) {\n                this.combineState({ sortOption: currentOption[0] });\n            } else {\n                this.combineState({ sortOption: [currentOption] });\n            }\n        } else {\n            if (Array.isArray(sortOptionIndex)) {\n                this.combineState({ sortOption: this.getSortOptionFromIndex(sortOptionIndex) as SortOption[] });\n            } else {\n                this.combineState({ sortOption: this.getSortOptionFromIndexSingle(sortOptionIndex) });\n            }\n        }\n    }\n\n\n\n    getSortOptionFromIndex(sortOptionIndex: number[]) {\n        if (sortOptionIndex.length === 0) {\n            return this.getSortOptions()[0];\n        }\n        return sortOptionIndex.map(this.getSortOptionFromIndexSingle);\n    }\n\n    getSortOptionFromIndexSingle(sortOptionIndex: number) {\n        const sortingOptions = this.getSortOptions();\n        let option = sortingOptions[sortOptionIndex].sortoption;\n        if (option === undefined && sortingOptions[sortOptionIndex].value === 7) {\n            option = {\n                type: \"suggestedPlayers\",\n                numberOfPlayers: this.state.filterOptions.playerCount\n            };\n        }\n        return option;\n    }\n\n    combineState(options: FilterAndSortOptions) {\n        const newFilter = Object.assign({}, this.state.filterOptions, options);\n        if (this.props.onFilterChange) {\n            this.props.onFilterChange(newFilter);\n        }\n        this.setState({ filterOptions: newFilter });\n    }\n\n    joinWithAndEnd(strings: string[]): string {\n        if (strings.length === 1) {\n            return strings[0];\n        }\n        const newStrings = [...strings];\n        const last = newStrings.pop();\n        return newStrings.join(\", \") + \" and \" + last;\n    }\n\n    getDropdownValues() {\n        const options = this.state.filterOptions.sortOption;\n        const sortingOptions = this.getSortOptions();\n        if (options === undefined) {\n            return undefined;\n        }\n        if (Array.isArray(options)) {\n            if (options.length === 1 && options[0] === undefined) {\n                return [];\n            }\n            return options.map((o) => typeof o === \"object\" ? 7 : sortingOptions.findIndex((so) => so.sortoption === o));\n        } else {\n            return typeof options === \"object\" ? 7 : sortingOptions.findIndex((so) => so.sortoption === options);\n        }\n    }\n\n    render() {\n\n\n        const { currentUsers = [\"Unknown\"] } = this.props;\n        const options = this.state.filterOptions.sortOption;\n        const allowMultiSelect = Array.isArray(options);\n        const oneUser = currentUsers.length <= 1;\n        const iWe = oneUser ? \"I\" : \"we\";\n        const amAre = oneUser ? \"am\" : \"are\";\n        const sortingOptions = this.getSortOptions();\n        const values = this.getDropdownValues();\n        const timeOptions = this.getOptions();\n        return (\n            <Container fluid>\n                <div className=\"topMenu ui fixed\" >\n                    <div className=\"ui container\">\n                        <span className=\"topselect\">\n                            <span>Hi {iWe}  {amAre} </span>\n                            <span><a href=\"#\"><b>{this.joinWithAndEnd(currentUsers)}</b></a></span>\n                            <span> {iWe}  {amAre} looking for a </span>\n                            <span>boardgame </span>\n                            <span className=\"topselect\">\n                                <span>that plays in </span>\n                                <Dropdown\n                                    inline={true}\n                                    placeholder=\"any time\"\n                                    data-testid=\"PlaytimeDropdown\"\n                                    options={timeOptions}\n                                    closeOnChange={true}\n                                    onChange={(_e, d) => this.onTimeChange(d.value as number)} />\n                            </span>\n                        </span>\n\n                        <span className=\"topselect\">\n                            <span>with </span>\n                            <Dropdown\n                                inline={true}\n                                placeholder=\"any number of players\"\n                                data-testid=\"PlayercountDropdown\"\n                                options={playercountOptions}\n                                closeOnChange={true}\n                                onChange={(_e, d) => this.onPlayerCountChange(d.value as number)} />\n                        </span>\n\n                        <span className=\"topselect\">\n                            <span>and {iWe} prefer games that </span>\n                            <Dropdown\n                                inline={true}\n                                placeholder={sortingOptions[0].text}\n                                data-testid=\"SortOptionDropdown\"\n                                options={this.getSortOptions()}\n                                multiple={allowMultiSelect}\n                                closeOnChange={!allowMultiSelect}\n                                value={values}\n                                onChange={(_e, d) => this.onSortChange(d.value as number[])} />\n                        </span>\n                    </div>\n                </div>\n            </Container>\n        );\n    }\n}\n\n// --- GameListItem ---\n\ntype Size = \"mini\" | \"tiny\" | \"small\" | \"medium\" | \"large\" | \"big\" | \"huge\" | \"massive\";\n\nexport interface GameListItemProps {\n    item: GameInfoPlus;\n    size?: Size;\n}\n\nconst gameDescription = new DescriptionGenerator();\n\n/**\n * PureComponent that renders  a given GameInfo item into a list like view.\n */\nexport class GameListItem extends React.PureComponent<GameListItemProps> {\n\n    render() {\n        const { item, size } = this.props;\n        const { owners = [] } = item;\n        return (\n            <Item >\n                <Item.Image size={size}><img data-testid=\"GameImage\" src={item.imageUrl} /></Item.Image>\n                <Item.Content verticalAlign={\"middle\"}>\n                    <Item.Header data-testid=\"GameName\" href={\"https://boardgamegeek.com/boardgame/\" + item.id} as=\"a\" size={size} target=\"_blank\">{item.name}</Item.Header>\n                    <Item.Meta data-testid=\"GameYear\">\n                        <span>{item.yearPublished}</span>\n                        {item.owners && <span data-testid=\"Owners\"> - <span>{owners.join(\", \")}</span></span>}\n\n                    </Item.Meta >\n                    <Item.Description data-testid=\"GameDescription\">\n                        {gameDescription.generateDescription(item)}\n                    </Item.Description>\n                    {(\"categories\" in item) && <Item.Extra>{item.categories.join(\", \")}</Item.Extra>}\n                </Item.Content>\n            </Item>\n        );\n    }\n}\n\n// --- GameCardItem ---\n\ninterface GameCardItemProps {\n    item: GameInfoPlus;\n    size?: Size;\n}\n\n/**\n * PureComponent that renders a given GameInfo item into a card view.\n */\nclass GameCardItem extends React.PureComponent<GameCardItemProps> {\n    render() {\n        const { item, size } = this.props;\n        const { owners = [] } = item;\n        return (\n            <Card size={size}>\n                <Image src={item.imageUrl} size={\"massive\"} wrapped ui={false} />\n                <Card.Content>\n                    <Card.Header>{item.name}</Card.Header>\n                    <Card.Meta>\n                        <span className=\"date\">{(item.yearPublished || \"\") + \" - \" + owners.join(\", \")}</span>\n                    </Card.Meta>\n                    <Card.Description>\n                        {gameDescription.generateDescription(item)}\n                    </Card.Description>\n                </Card.Content>\n                <Card.Content extra>\n                    {(\"categories\" in item) && item.categories && item.categories.join(\", \")}\n                </Card.Content>\n            </Card>\n        );\n    }\n}\n\n// --- PickAGameForMe ---\n\ninterface PickAGameProps {\n    games: GameInfoPlus[];\n}\n\ninterface PickAGameState {\n    pickedGame?: GameInfoPlus;\n    gamesAlreadyShown: GameInfoPlus[];\n}\n\nconst pickAGameInitialState = {\n    pickedGame: undefined,\n    gamesAlreadyShown: []\n};\n\nclass PickAGameForMe extends React.Component<PickAGameProps, PickAGameState> {\n\n    constructor(props: PickAGameProps) {\n        super(props);\n        this.state = pickAGameInitialState;\n        this.pickARandomGame = this.pickARandomGame.bind(this);\n        this.close = this.close.bind(this);\n    }\n\n    pickARandomGame() {\n        const games = this.props.games;\n        let gamesAlreadyShown = [...this.state.gamesAlreadyShown];\n        let gamesToPickFrom = games.filter((gameToPossiblyPickFrom) => gamesAlreadyShown.every((alreadyShownGame) => alreadyShownGame.id !== gameToPossiblyPickFrom.id));\n        if (gamesToPickFrom.length === 0) {\n            gamesAlreadyShown = [];\n            gamesToPickFrom = games;\n        }\n        const randomIndexDice = new Array(3).fill(0).map(() => this.randomInteger(0, gamesToPickFrom.length - 1));\n        const randomIndex = randomIndexDice.reduce((p, c) => Math.min(p, c), Math.ceil((gamesToPickFrom.length - 1) / 2));\n        const pickedGame = gamesToPickFrom[randomIndex];\n        gamesAlreadyShown.push(pickedGame);\n        this.setState({\n            pickedGame: pickedGame,\n            gamesAlreadyShown: gamesAlreadyShown\n        });\n    }\n\n    randomInteger(from: number, to: number): number {\n        return Math.floor(Math.random() * to) + from;\n    }\n\n    close() {\n        this.setState(pickAGameInitialState);\n    }\n\n    render() {\n        const pickedGame = this.state.pickedGame;\n        if (pickedGame) {\n            return (\n                <Dimmer inverted active={true} onClick={this.close}>\n                    <Container >\n                        <Segment>\n                            <Header as=\"h3\">What about this game?</Header>\n                            <Item.Group >\n                                <GameListItem size={\"large\"} item={pickedGame} />\n                            </Item.Group>\n                            <Button className=\"large\" color=\"black\" onClick={(e) => {\n                                e.stopPropagation();\n                                this.pickARandomGame();\n                            }} >\n                                <Icon name=\"cube\" />Find another\n                            </Button>\n                        </Segment>\n                    </Container>\n\n                </Dimmer >\n            );\n        } else {\n            return (\n                <Container text >\n                    <Button fluid basic onClick={(e) => {\n                        e.stopPropagation();\n                        this.pickARandomGame();\n                    }}>\n                        <Icon name=\"cube\" />Pick a game for me!\n            </Button>\n                </Container>\n            );\n        }\n    }\n}\n\n// --- CollectionList ---\n\ninterface CollectionListProps {\n    games: GameInfoPlus[];\n}\n\nclass CollectionList extends React.PureComponent<CollectionListProps> {\n    render() {\n        const { games } = this.props;\n        return (\n            <Item.Group>\n                {games.map((game) => <GameListItem key={game.id} item={game} />)}\n            </Item.Group>\n        );\n    }\n}\n\n// --- CollectionGrid ---\n\ninterface CollectionGridProps {\n    games: GameInfoPlus[];\n}\n\nclass CollectionGrid extends React.PureComponent<CollectionGridProps> {\n    render() {\n        const { games } = this.props;\n        return (\n            <Card.Group centered  >\n                {games.map((game) => <GameCardItem key={game.id} item={game} />)}\n            </Card.Group>\n        );\n    }\n}\n\n\n// --- Helper Components ---\n\nclass NoGamesFound extends React.PureComponent<Record<string, never>> {\n    render() {\n        return (\n            <Header as=\"h2\" icon textAlign=\"center\" data-testid=\"nogames\">\n                <Icon name=\"frown\" circular />\n                <Header.Content>\n                    <span >Sorry, I could not find any games that match what you are looking for.</span>\n                </Header.Content>\n            </Header>\n        );\n    }\n}\n\nclass Footer extends React.PureComponent<Record<string, never>> {\n    render() {\n        return (\n            <Container text className=\"Footer\">\n                <Divider />\n                <List horizontal>\n                    <List.Item>\n                        <Header className=\"faded\" as=\"h5\">\n                            <a href=\"about.html\">About Cardboard Butler </a>\n                        </Header >\n                    </List.Item>\n                    <List.Item>\n                        <Header className=\"faded\" as=\"h5\">\n                            <a href=\"https://github.com/PhilipK/CardboardButler\">Github Page</a>\n                        </Header >\n                    </List.Item>\n                    <List.Item>\n                        <Header className=\"faded\" as=\"h5\">\n                            <a href=\"https://boardgamegeek.com/support\">Support BGG</a>\n                        </Header >\n                    </List.Item>\n                </List>\n                <Divider hidden />\n            </Container>\n        );\n    }\n}\n\n// --- Main Component: CollectionPage ---\n\ntype ViewType = \"grid\" | \"list\";\n\ninterface Props {\n    games?: GameInfoPlus[];\n    currentUsers?: string[];\n}\n\ninterface State {\n    filterOptions: FilterAndSortOptions;\n    viewType: ViewType;\n}\n\nexport default class CollectionPage extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.onFilterChange = this.onFilterChange.bind(this);\n        this.onSetViewType = this.onSetViewType.bind(this);\n        this.state = { filterOptions: {}, viewType: \"list\" };\n    }\n\n    onFilterChange(filterOptions: FilterAndSortOptions) {\n        this.setState({\n            filterOptions: filterOptions\n        });\n    }\n\n    onSetViewType(viewType: ViewType) {\n        this.setState({\n            viewType: viewType\n        });\n    }\n\n    render() {\n        const { games = [], currentUsers = [] } = this.props;\n        const { viewType } = this.state;\n        const filterer = new GamesFilterAndSorter();\n        const filteredGames = filterer.filterAndSort(games, this.state.filterOptions);\n        const noGames = filteredGames.length === 0;\n        return (\n            <div data-testid=\"CollectionPage\">\n                <div style={{ position: \"absolute\", top: 20, right: 20 }}>\n                    <Icon size=\"small\" inverted={viewType === \"list\"} bordered circular name=\"list\" onClick={() => this.onSetViewType(\"list\")} />\n                    <Icon size=\"small\" inverted={viewType === \"grid\"} bordered circular name=\"grid layout\" onClick={() => this.onSetViewType(\"grid\")} />\n                </div>\n                <Container fluid textAlign=\"center\" className=\"logoHeader\">\n                    <Header as=\"h1\">\n                        <span className=\"logoscript\">Cardboard Butler</span>\n                    </Header>\n                </Container>\n                <FilterBar onFilterChange={this.onFilterChange} currentUsers={currentUsers} />\n\n                {noGames && <NoGamesFound />}\n\n                {filteredGames.length > 0 && <Container text fluid>\n                    <PickAGameForMe games={filteredGames} />\n                    <Divider hidden />\n                </Container>\n                }\n                <Container fluid text={viewType === \"list\"}>\n                    {viewType === \"list\" &&\n                        <CollectionList games={filteredGames} />\n                    }\n                    {viewType === \"grid\" &&\n                        <CollectionGrid games={filteredGames} />\n                    }\n                </Container>\n                <Footer />\n\n            </div>\n        );\n    }\n}\n","import { GameInfoPlus, GameInfo, SortOption, FilterAndSortOptions } from \"../types\";\nconst memoize = require(\"fast-memoize\");\n\n/**\n * A soter takes a collection and returns that collection sorted.\n */\nexport interface Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[];\n}\n\nexport class BggRatingSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.averageRatingSorter);\n    }\n    private averageRatingSorter(a: GameInfo, b: GameInfo): number {\n        return b.averagerating - a.averagerating;\n    }\n}\n\nexport class HeavySorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.weightHeavySort);\n    }\n    private weightHeavySort(a: GameInfoPlus, b: GameInfoPlus): number {\n        const aValue = \"weight\" in a ? a.weight : undefined;\n        const bValue = \"weight\" in b ? b.weight : undefined;\n        return (bValue || 0) - (aValue || 0);\n    }\n}\n\nexport class LightSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.weightLightSort);\n    }\n    private weightLightSort(a: GameInfoPlus, b: GameInfoPlus): number {\n        const aValue = \"weight\" in a ? a.weight : undefined;\n        const bValue = \"weight\" in b ? b.weight : undefined;\n        return (aValue || 99) - (bValue || 99);\n    }\n\n}\n\ninterface IndexMap {\n    [gameid: number]: number[];\n\n}\n\nexport class MultiSorter implements Sorter {\n\n    innerSorters: Sorter[];\n\n    constructor(innerSorters: Sorter[]) {\n        this.innerSorters = innerSorters;\n    }\n\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        const mutableCollection = [...collection];\n        const sortedCollections = this.innerSorters.map((sorter) => {\n            sorter.sort(mutableCollection);\n            return [...mutableCollection];\n        });\n        const indexMaps = sortedCollections.map((collection) => collection.reduce((prev, cur, index) => {\n            prev[cur.id] = [index];\n            return prev;\n        }, {} as IndexMap));\n        const multiScoreMap = indexMaps.reduce((prev, cur) => {\n            Object.keys(cur).forEach((gameId) => {\n                prev[gameId] = (prev[gameId] || []).concat(cur[gameId]);\n            });\n            return prev;\n        }, {} as IndexMap);\n        const combinedComparator = this.createCompareWithMap(multiScoreMap);\n        return mutableCollection.sort(combinedComparator);\n    }\n\n    private createCompareWithMap(indexMap: IndexMap) {\n        return (a: GameInfo, b: GameInfo) => {\n            const aScore = indexMap[a.id].reduce((p, c) => p + c, 0);\n            const bScore = indexMap[b.id].reduce((p, c) => p + c, 0);\n            const score = aScore - bScore;\n            return score === 0 ? indexMap[a.id][0] - indexMap[b.id][0] : score;\n        };\n    }\n\n}\n\nexport class NameSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.nameSorter);\n    }\n    private nameSorter(a: GameInfo, b: GameInfo): number {\n        return a.name.localeCompare(b.name);\n    }\n\n}\n\nexport class OldSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.oldYearSorter);\n    }\n    private oldYearSorter(a: GameInfo, b: GameInfo): number {\n        return (a.yearPublished || Infinity) - (b.yearPublished || Infinity);\n    }\n}\n\nfunction getSafePlayCount(a: GameInfoPlus) {\n    return (\"plays\" in a && a.plays && a.plays.length) || 0;\n}\n\nexport class PlayedALotSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.recentlySoter);\n    }\n    private recentlySoter(a: GameInfoPlus, b: GameInfoPlus): number {\n        return getSafePlayCount(b) - getSafePlayCount(a);\n    }\n\n}\n\nfunction getSafeLastPlayed(a: GameInfoPlus) {\n    return (\"lastPlayed\" in a && a.lastPlayed && a.lastPlayed.getTime()) || 0;\n}\n\nexport class PlayedLongAgoSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.recentlySoter);\n    }\n    private recentlySoter(a: GameInfoPlus, b: GameInfoPlus): number {\n        return getSafeLastPlayed(a) - getSafeLastPlayed(b);\n    }\n\n}\n\nexport class PlayedNotALotSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.recentlySoter);\n    }\n    private recentlySoter(a: GameInfoPlus, b: GameInfoPlus): number {\n        return getSafePlayCount(a) - getSafePlayCount(b);\n    }\n\n}\n\nexport class RecentlyPlayedSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.recentlySoter);\n    }\n    private recentlySoter(a: GameInfoPlus, b: GameInfoPlus): number {\n        return getSafeLastPlayed(b) - getSafeLastPlayed(a);\n    }\n\n}\n\nexport class SuggestedPlayersSorter implements Sorter {\n    playerCount?: number;\n\n    constructor(playerCount?: number) {\n        this.playerCount = playerCount;\n    }\n\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        if (this.playerCount !== undefined) {\n            return collection.sort(this.getSuggestedComparatorComparator(this.playerCount));\n        }\n        return collection;\n\n    }\n    private getSuggestedComparatorComparator(playerCount: number) {\n        return (a: GameInfoPlus, b: GameInfoPlus) => {\n            return this.getSuggestePlayerScore(playerCount, b) - this.getSuggestePlayerScore(playerCount, a);\n        };\n    }\n\n    private getSuggestePlayerScore(playerCount: number, gameInfo: GameInfoPlus): number {\n        if (\"suggestedNumberOfPlayers\" in gameInfo) {\n            const votes = gameInfo.suggestedNumberOfPlayers[playerCount] || gameInfo.suggestedNumberOfPlayers[Infinity];\n            if (votes !== undefined) {\n                const total = votes.best + votes.recommended + votes.notRecommended;\n                const score = (votes.best / total * 3) + (votes.recommended / total) - (votes.notRecommended / total * 2);\n                return score;\n            }\n        }\n        return -Infinity;\n\n\n    }\n}\n\nexport class UserRatingSorter implements Sorter {\n\n    constructor() {\n        this.userRatingSorter = this.userRatingSorter.bind(this);\n    }\n\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.userRatingSorter);\n    }\n\n    private userRatingSorter(a: GameInfo, b: GameInfo): number {\n        const aRating = this.getAverageUserRating(a);\n        const bRating = this.getAverageUserRating(b);\n        return (bRating || 0) - (aRating || 0);\n    }\n\n    private getAverageUserRating(a: GameInfo) {\n        const scoreMap = a.userRating;\n        if (!scoreMap) {\n            return undefined;\n        } else {\n            const userNames = Object.keys(scoreMap);\n            const userNamesWithRatings = userNames.filter((name) => scoreMap[name]);\n            if (userNamesWithRatings.length === 0) {\n                return undefined;\n            }\n            const sum = userNamesWithRatings.reduce((p, c) => p + scoreMap[c], 0);\n            return sum / userNamesWithRatings.length;\n        }\n    }\n}\n\nexport class YoungSorter implements Sorter {\n    sort(collection: GameInfoPlus[]): GameInfoPlus[] {\n        return collection.sort(this.newYearSorter);\n    }\n    private newYearSorter(a: GameInfo, b: GameInfo): number {\n        return (b.yearPublished || -100000) - (a.yearPublished || -10000);\n    }\n}\n\nconst sortMap = {\n    alphabetic: new NameSorter(),\n    bggrating: new BggRatingSorter(),\n    new: new YoungSorter(),\n    old: new OldSorter(),\n    userrating: new UserRatingSorter(),\n    \"weight-heavy\": new HeavySorter(),\n    \"weight-light\": new LightSorter(),\n    \"playedRecently\": new RecentlyPlayedSorter(),\n    \"playedLongAgo\": new PlayedLongAgoSorter(),\n    \"playedALot\": new PlayedALotSorter(),\n    \"playedNotALot\": new PlayedNotALotSorter()\n};\n\nconst DEFAULT_OPTION = \"bggrating\";\n\nfunction getSorterInner(sortOption: (SortOption | SortOption[]) = DEFAULT_OPTION): Sorter {\n    if (Array.isArray(sortOption)) {\n        const innerSorters = sortOption.map(getSorterInner);\n        return new MultiSorter(innerSorters);\n    }\n    if (typeof sortOption === \"object\") {\n        return new SuggestedPlayersSorter(sortOption.numberOfPlayers);\n    }\n    return sortMap[sortOption];\n}\n\nconst getSorter = memoize(getSorterInner);\n\n\nexport class GameSorter {\n\n    constructor() {\n        this.sortCollection = memoize(this.sortCollectionInner);\n\n    }\n\n    public sortCollection: (collection: GameInfoPlus[], sortOption: (SortOption | SortOption[])) => GameInfoPlus[];\n\n    private sortCollectionInner(collection: GameInfoPlus[], sortOption: (SortOption | SortOption[])): GameInfoPlus[] {\n        const sorter = getSorter(sortOption);\n        return sorter.sort(collection);\n    }\n\n}\n\nexport class GameFilterer {\n\n    constructor() {\n        this.filterCollectionInner = this.filterCollectionInner.bind(this);\n        this.filterCollection = memoize(this.filterCollectionInner);\n    }\n\n    public filterCollection: (collection: GameInfo[], options: FilterAndSortOptions) => GameInfo[];\n\n    private filterCollectionInner(collection: GameInfo[], options: FilterAndSortOptions) {\n        const { playtime, playerCount } = options;\n        if (playtime) {\n            collection = this.filterOnTime(collection, playtime);\n        }\n        if (playerCount) {\n            collection = this.filterOnPlayerCount(collection, playerCount);\n        }\n        return collection;\n    }\n\n    private filterOnTime(collection: GameInfo[], playtime: { minimum?: number; maximum?: number; }) {\n        const { minimum = 0, maximum = Infinity } = playtime;\n        return collection.filter((game) =>\n            minimum <= (game.minPlaytime || 0) && (game.maxPlaytime || Infinity) <= maximum\n        );\n    }\n\n    private filterOnPlayerCount(collection: GameInfo[], playerCount: number) {\n        return collection.filter((game) => game.minPlayers <= playerCount && playerCount <= game.maxPlayers);\n    }\n}\n\n/**\n * Filters and sorts a given collection and some options on how to do it.\n */\nexport class GamesFilterAndSorter {\n    sorter: GameSorter;\n    filterer: GameFilterer;\n\n    constructor(sorter: GameSorter = new GameSorter(), filterer: GameFilterer = new GameFilterer()) {\n        this.sorter = sorter;\n        this.filterer = filterer;\n        this.filterAndSortInner = this.filterAndSortInner.bind(this);\n        this.filterAndSort = memoize(this.filterAndSortInner);\n    }\n\n    /**\n     * Filters and sorts a given collection, returns a new collection.\n     * @param collection a collection of games to filter and sort\n     * @param options optional options, that defines how the collection should be filtered and sorted.\n     */\n\n    filterAndSort: (collection: GameInfoPlus[], options?: FilterAndSortOptions) => GameInfoPlus[];\n\n    filterAndSortInner(collection: GameInfoPlus[], options: FilterAndSortOptions = {}): GameInfoPlus[] {\n        const collectionCopy = [...collection];\n        const filtered = this.filterer.filterCollection(collectionCopy, options);\n        return this.sorter.sortCollection(filtered, options.sortOption);\n    }\n\n\n}\n","import BggGameService, { BggRetryResult } from \"./BggGameService\";\nimport { GameInfo, GameInfoPlus, ExtendedGameInfo, PlayInfo, GamePlayInfo } from \"../types\";\nconst memoize = require(\"fast-memoize\");\n\n// --- CollectionMerger ---\n\nexport interface CollectionMap {\n    [username: string]: GameInfo[];\n}\n\nexport interface CollectionMapPlus {\n    [username: string]: GameInfoPlus[];\n}\n\ninterface GameIdCache {\n    [id: number]: GameInfo | undefined;\n}\n\n\n/**\n * A collection merger, can merge multiple collections of game inforamtion.\n */\nexport class CollectionMerger {\n\n    /**\n    * Merges multiple collections.\n    * A single game array is returned, with one instance of each game in the collections.\n    * Each game has had its owners and userratings fields updated, to include each owner and their rating.\n    * @param collectionsMap A map between usernames and their collections\n    */\n    public getMergedCollection: (collectionsMap: CollectionMapPlus) => GameInfo[];\n\n    constructor() {\n        this.getMergedCollection = memoize(this.getMergedCollectionInner);\n    }\n\n    private getMergedCollectionInner(collectionsMap: CollectionMapPlus): GameInfo[] {\n        const cache: GameIdCache = {};\n        const sharedUserRatingSet = new Set<number>();\n        const userNames = Object.keys(collectionsMap);\n        userNames.forEach((username) => {\n            const currentCollection = collectionsMap[username];\n            currentCollection.forEach((currentGame) => {\n                const alreadyKnownGame = cache[currentGame.id];\n                if (alreadyKnownGame) {\n                    alreadyKnownGame.owners.push(username);\n                    if (currentGame.userRating) {\n                        if (!alreadyKnownGame.userRating) {\n                            alreadyKnownGame.userRating = Object.assign({}, currentGame.userRating);\n                        } else {\n                            if (sharedUserRatingSet.has(currentGame.id)) {\n                                alreadyKnownGame.userRating = Object.assign({}, alreadyKnownGame.userRating);\n                                sharedUserRatingSet.delete(currentGame.id);\n                            }\n                            Object.assign(alreadyKnownGame.userRating, currentGame.userRating);\n                        }\n                    }\n                } else {\n                    cache[currentGame.id] = Object.assign({}, currentGame, { owners: [username] });\n                    if (currentGame.userRating) {\n                        sharedUserRatingSet.add(currentGame.id);\n                    }\n                }\n            });\n        });\n        return Object.values(cache);\n    }\n}\n\n// --- BggGameLoader ---\n\n\ninterface LoadingStatus {\n    isLoading: boolean;\n    retryInfo?: BggRetryResult;\n}\n\n\ninterface GameLoadingInfo {\n    type: \"game\";\n    gameinfo: GameInfo;\n}\n\ninterface CollectionLoadingInfo {\n    type: \"collection\";\n    username: string;\n}\n\nexport interface PlaysLoadingInfo {\n    type: \"plays\";\n    username: string;\n}\nconst storageVersion = \"2\";\n\n\nexport type LoadingInfo = LoadingStatus & (GameLoadingInfo | CollectionLoadingInfo | PlaysLoadingInfo);\n\ninterface ExtraInfoMap {\n    [id: number]: (ExtendedGameInfo | undefined);\n}\n\ninterface PlaysMap {\n    [username: string]: (PlayInfo[] | undefined);\n}\n\ntype CollectionUpdateEventHandler = (games: GameInfoPlus[]) => void;\ntype LoadingUpdateEventHandler = (games: LoadingInfo[]) => void;\n\n\nexport default class BggGameLoader {\n\n    private readonly service: BggGameService;\n    private collectionMap: CollectionMapPlus = {};\n\n    private extraInfoMap: ExtraInfoMap = {};\n    private playsMap: PlaysMap = {};\n\n\n    private currentNames: string[] = [];\n    private loadingInfo: LoadingInfo[] = [];\n    private readonly eventHandlers: CollectionUpdateEventHandler[] = [];\n    private readonly loadingEventHandlers: LoadingUpdateEventHandler[] = [];\n\n    private readonly merger: CollectionMerger;\n    private useCache: boolean;\n\n\n    private concurrentRequestLimit = 5;\n\n\n    constructor(bggService: BggGameService, merger: CollectionMerger, useCache = false) {\n        this.service = bggService;\n        this.loadCollections = this.loadCollections.bind(this);\n        this.loadCollectionWithRetry = this.loadCollectionWithRetry.bind(this);\n        this.getAllGamesPlus = this.getAllGamesPlus.bind(this);\n        this.getAllGamesPlusPure = this.getAllGamesPlusPure.bind(this);\n        this.informCollectionUpdateHandlers = this.informCollectionUpdateHandlers.bind(this);\n        this.getAllGamesPlusPureMemo = memoize(this.getAllGamesPlusPure);\n        this.getShownGamesMapMemo = memoize(this.getShownGamesMap);\n        this.getGamesWithExtraInfoMemo = memoize(this.getGamesWithExtraInfo);\n        this.getGamesWithPlayInfoMemo = memoize(this.getGamesWithPlayInfo);\n        this.merger = merger;\n        this.useCache = useCache;\n        this.extraInfoMap = {};\n        this.loadCollectionsFromCache();\n        this.loadExtraInfo();\n        this.setStorageVersion();\n    }\n\n    public async loadCollections(usernames: string[]): Promise<GameInfo[][]> {\n        this.currentNames = usernames;\n        this.informCollectionUpdateHandlers();\n        return await Promise.all(usernames.map(async (username) => {\n            const games = await this.loadCollectionWithRetry(username);\n            this.collectionMap[username] = games;\n            this.storeCollections();\n            this.informCollectionUpdateHandlers();\n            return games;\n        }));\n\n    }\n\n    public async loadExtendedInfo() {\n        const allGames = this.getAllGamesPlus();\n        const allUnknownGames = allGames.filter((game) => this.extraInfoMap[game.id] === undefined);\n        const loadingInfo: LoadingInfo[] = allUnknownGames.map((game) => ({\n            type: \"game\",\n            isLoading: false,\n            gameinfo: game\n        }));\n        this.loadingInfo = [...loadingInfo, ...this.loadingInfo];\n        const chunks = this.chunk(allUnknownGames, 50);\n        return await Promise.all(chunks.map((unknownGames) => {\n            return this.loadGamesWithRetry(unknownGames).then((extraInfos) => {\n                extraInfos.forEach((extraInfo, i) => {\n                    this.extraInfoMap[unknownGames[i].id] = extraInfo;\n                });\n                this.informCollectionUpdateHandlers();\n                return extraInfos;\n            });\n        })).then((games) => {\n            this.storeExtraInfo();\n            return games;\n        });\n    }\n\n    private chunk<T>(input: T[], chunkSize: number): T[][] {\n        const chunked_arr: T[][] = [];\n        const copied = [...input];\n        const numOfChild = Math.ceil(copied.length / chunkSize);\n        for (let i = 0; i < numOfChild; i++) {\n            chunked_arr.push(copied.splice(0, chunkSize));\n        }\n        return chunked_arr;\n    }\n\n\n    private storeExtraInfo() {\n        if (localStorage && this.useCache) {\n            localStorage.setItem(\"extrainfo\", JSON.stringify(this.extraInfoMap));\n        }\n    }\n\n    private loadExtraInfo() {\n        this.extraInfoMap = {};\n        if (localStorage && this.useCache) {\n            if (localStorage.getItem(\"storageVersion\") !== storageVersion) {\n                localStorage.removeItem(\"extrainfo\");\n            }\n            const cache = JSON.parse(localStorage.getItem(\"extrainfo\")) as ExtraInfoMap;\n            if (cache) {\n                this.extraInfoMap = cache;\n            }\n        }\n    }\n    private setStorageVersion() {\n        if (localStorage && this.useCache) {\n            localStorage.setItem(\"storageVersion\", storageVersion);\n        }\n    }\n\n\n    private storeCollections() {\n        if (localStorage && this.useCache) {\n            localStorage.setItem(\"collections\", JSON.stringify(this.collectionMap));\n        }\n    }\n\n    private loadCollectionsFromCache() {\n        this.collectionMap = {};\n        if (localStorage && this.useCache) {\n            if (localStorage.getItem(\"storageVersion\") !== storageVersion) {\n                localStorage.removeItem(\"collections\");\n            }\n            const cache = JSON.parse(localStorage.getItem(\"collections\")) as CollectionMap;\n            if (cache) {\n                this.collectionMap = cache;\n            }\n        }\n    }\n\n    private getShownGamesMapMemo: (currentNames: string[], collectionMap: CollectionMap) => CollectionMap;\n    private getShownGamesMap(currentNames: string[], collectionMap: CollectionMap) {\n        return currentNames.reduce((prev, cur) => {\n            const known = collectionMap[cur];\n            if (known) {\n                prev[cur] = known;\n            }\n            return prev;\n        }, {} as CollectionMap);\n    }\n\n    private getGamesWithExtraInfoMemo: (games: GameInfo[], extraInfoMap: ExtraInfoMap) => GameInfoPlus[];\n\n    private getGamesWithExtraInfo(games: GameInfo[], extraInfoMap: ExtraInfoMap) {\n        return games.map((ag) => Object.assign({}, ag, extraInfoMap[ag.id] || {}));\n    }\n\n\n    private getGamesWithPlayInfoMemo: (currentNames: string[], games: GameInfo[], playsMap: PlaysMap) => GameInfo[];\n\n    private getGamesWithPlayInfo(currentNames: string[], games: GameInfo[], playsMap: PlaysMap) {\n        if (Object.keys(playsMap).length > 0) {\n            const allGamesWithPlays = games.map((game) => {\n                const allPlaysOfGame: PlayInfo[] = [];\n                currentNames.forEach((name) => {\n                    const usersPlays = playsMap[name];\n                    if (usersPlays) {\n                        for (let i = 0; i < usersPlays.length; i++) {\n                            const usersPlay = usersPlays[i];\n                            if (usersPlay.gameId === game.id) {\n                                allPlaysOfGame.push(Object.assign({}, usersPlay, { playedBy: name }));\n                            }\n                        }\n                    }\n                });\n\n                const lastPlayInMinutes = allPlaysOfGame.reduce((prev, cur) => Math.max(prev, cur.date.getTime()), 0);\n                const timePlayedInMinutes = allPlaysOfGame.reduce((prev, cur) => prev + (cur.length || 0), 0);\n                const result: GamePlayInfo = {\n                    plays: allPlaysOfGame,\n                    lastPlayed: lastPlayInMinutes ? new Date(lastPlayInMinutes) : undefined,\n                    timePlayedMinutes: timePlayedInMinutes\n\n                };\n                return Object.assign({}, game, result);\n            });\n            return allGamesWithPlays;\n\n        } else {\n            return games;\n        }\n    }\n\n    private getAllGamesPlus() {\n        const { currentNames, collectionMap, extraInfoMap, playsMap } = this;\n        return this.getAllGamesPlusPureMemo(currentNames, collectionMap, extraInfoMap, playsMap);\n    }\n\n    private getAllGamesPlusPureMemo: (currentNames: string[], collectionMap: CollectionMapPlus, extraInfoMap: ExtraInfoMap, playsMap: PlaysMap) => GameInfo[];\n\n    private getAllGamesPlusPure(currentNames: string[], collectionMap: CollectionMapPlus, extraInfoMap: ExtraInfoMap, playsMap: PlaysMap): GameInfo[] {\n        const shownGamesMap = this.getShownGamesMapMemo(currentNames, collectionMap);\n        const allGames = this.merger.getMergedCollection(shownGamesMap);\n        const allGamesPlus = this.getGamesWithExtraInfoMemo(allGames, extraInfoMap);\n        const allGamesPlusWithPlays = this.getGamesWithPlayInfoMemo(currentNames, allGamesPlus, playsMap);\n        return allGamesPlusWithPlays;\n    }\n\n\n\n    private informCollectionUpdateHandlers() {\n        const allGamesPlus = this.getAllGamesPlus();\n        this.eventHandlers.forEach((handler) => handler(allGamesPlus));\n    }\n\n    private informLoadingHandlers() {\n        const loadingInfo = this.getLoadingInfo();\n        this.loadingEventHandlers.forEach((handler) => handler(loadingInfo));\n    }\n\n    public async loadPlays() {\n        const names = this.currentNames;\n        return Promise.all(names.map(async (name) => {\n            this.loadingInfo = this.loadingInfo.filter((n) => n.type !== \"plays\" || (n.type === \"plays\" && n.username !== name));\n            this.loadingInfo.push({\n                isLoading: true,\n                type: \"plays\",\n                username: name\n            });\n            this.informLoadingHandlers();\n            const playerPlays = await this.loadPlaysWithRetry(name);\n            this.playsMap[name] = playerPlays;\n            this.loadingInfo = this.loadingInfo.filter((n) => n.type !== \"plays\" || (n.type === \"plays\" && n.username !== name));\n            this.informLoadingHandlers();\n            this.informCollectionUpdateHandlers();\n        }));\n    }\n\n    private async loadPlaysWithRetry(name: string): Promise<PlayInfo[]> {\n        const plays = await this.service.getPlays(name);\n        if (Array.isArray(plays)) {\n            return plays;\n        }\n        const retryTime = plays && plays.backoff ? 10000 : 1000;\n        return new Promise<PlayInfo[]>(resolver => {\n            setTimeout(() => resolver(this.loadPlaysWithRetry(name)), retryTime);\n        });\n\n    }\n\n\n    private async loadCollectionWithRetry(name: string): Promise<GameInfo[]> {\n        this.loadingInfo = this.loadingInfo.filter((n) => n.type === \"collection\" && n.username !== name);\n        this.loadingInfo.push({\n            isLoading: true,\n            type: \"collection\",\n            username: name\n        });\n        this.informLoadingHandlers();\n        const games = await this.service.getUserCollection(name);\n        if (Array.isArray(games)) {\n            this.loadingInfo = this.loadingInfo.filter((n) => n.type === \"collection\" && n.username !== name);\n            this.informLoadingHandlers();\n            return games;\n        } else {\n            const retryTime = games && games.backoff ? 10000 : 1000;\n            return new Promise<GameInfo[]>(resolver => {\n                setTimeout(() => resolver(this.loadCollectionWithRetry(name)), retryTime);\n            });\n        }\n    }\n\n    private async loadGamesWithRetry(games: GameInfo[]) {\n        const ids = games.map((g) => g.id);\n        ids.forEach((id) => {\n            const loadingIndex = this.loadingInfo.findIndex((li) => li.type === \"game\" && li.gameinfo.id === id);\n            this.loadingInfo[loadingIndex].isLoading = true;\n            this.loadingInfo[loadingIndex].retryInfo = undefined;\n        });\n        this.informLoadingHandlers();\n        const extendeds = await this.service.getGamesInfo(ids);\n        if (!(\"retryLater\" in extendeds)) {\n            ids.forEach((id) => {\n                this.loadingInfo = this.loadingInfo.filter((g) => g.type !== \"game\" || g.gameinfo.id !== id);\n            });\n            this.informLoadingHandlers();\n            return extendeds;\n        } else {\n            const retryTime = (extendeds && extendeds.backoff) ? 10000 : 3000;\n            if (extendeds && extendeds.backoff) {\n                this.concurrentRequestLimit = Math.max(this.concurrentRequestLimit - 1, 1);\n            }\n            ids.forEach((id) => {\n                const loadingIndex = this.loadingInfo.findIndex((li) => li.type === \"game\" && li.gameinfo.id === id);\n                this.loadingInfo[loadingIndex].retryInfo = extendeds;\n            });\n            this.informLoadingHandlers();\n            return new Promise<ExtendedGameInfo[]>(resolver => {\n                setTimeout(() => resolver(this.loadGamesWithRetry(games)), retryTime);\n            });\n        }\n    }\n\n    public onGamesUpdate(handler: CollectionUpdateEventHandler) {\n        this.eventHandlers.push(handler);\n    }\n\n    public getLoadingInfo(): LoadingInfo[] {\n        return this.loadingInfo;\n    }\n\n\n\n    public onLoadUpdate(handler: LoadingUpdateEventHandler) {\n        this.loadingEventHandlers.push(handler);\n    }\n\n\n}","import * as React from \"react\";\nimport { Header, Input, Icon } from \"semantic-ui-react\";\n\ninterface SelectUserInputProps {\n    bggNames?: string[];\n    onNameChange?: (newNames: string[]) => any;\n    validNames?: string[];\n    invalidNames?: string[];\n    loadingNames?: string[];\n    onNameSelect?: (names: string[]) => any;\n}\n\n\n/**\n * PureComponent that renders  a given GameInfo item into a list like view.\n */\nexport class SelectUserInput extends React.PureComponent<SelectUserInputProps> {\n\n    constructor(props: SelectUserInputProps) {\n        super(props);\n        this.onInputChange = this.onInputChange.bind(this);\n        this.getNamesToShow = this.getNamesToShow.bind(this);\n        this.onAddClick = this.onAddClick.bind(this);\n        this.onDeleteClick = this.onDeleteClick.bind(this);\n        this.onUseClick = this.onUseClick.bind(this);\n    }\n\n    onInputChange(value: string, index: number) {\n        // [DEBUG] Log input change\n        console.log(`[DEBUG] SelectUserInput: Input changed at index ${index} to value: '${value}'`);\n        if (this.props.onNameChange) {\n            const bggNames = this.props.bggNames || [];\n            const clone = [...bggNames];\n            clone[index] = value;\n            this.props.onNameChange(clone);\n        }\n    }\n\n    onAddClick() {\n        if (this.props.onNameChange) {\n            const newNamesToShow = this.getNamesToShow().concat([\"\"]);\n            this.props.onNameChange(newNamesToShow);\n        }\n    }\n\n    onDeleteClick(index: number) {\n        if (this.props.onNameChange && this.props.bggNames) {\n            const clone = [...this.props.bggNames];\n            clone.splice(index, 1);\n            this.props.onNameChange(clone);\n        }\n    }\n\n    getNamesToShow() {\n        const { bggNames } = this.props;\n        const namesToShow = (bggNames === undefined || bggNames.length === 0) ? [\"\"] : [...bggNames];\n        return namesToShow;\n\n    }\n\n    onUseClick() {\n        // [DEBUG] Log button click\n        console.log(\"[DEBUG] SelectUserInput: 'Use' button clicked. Current names:\", this.props.bggNames);\n        const { onNameSelect } = this.props;\n        if (onNameSelect) {\n            const names = this.props.bggNames;\n            const trimmedNames = names.map((name) => name.trim());\n            onNameSelect(trimmedNames);\n        } else {\n            console.warn(\"[DEBUG] SelectUserInput: onNameSelect prop is missing!\");\n        }\n    }\n\n    render() {\n        const namesToShow = this.getNamesToShow();\n        const showDelete = namesToShow.length > 1;\n        const { validNames = [], loadingNames = [], invalidNames = [] } = this.props;\n        const hasEnoughNames = namesToShow.length > 0 && namesToShow[0] !== \"\";\n        const forwardButtonText = `Can you help ${namesToShow.length === 1 ? \"me\" : \"us\"} find a game to play?`;\n        const canUseNames = hasEnoughNames && namesToShow.every((name) => validNames.indexOf(name) > -1);\n\n        // [DEBUG] Log render state to understand disabled button state\n        console.log(\"[DEBUG] SelectUserInput Render:\", {\n            namesToShow,\n            validNames,\n            invalidNames,\n            loadingNames,\n            hasEnoughNames,\n            canUseNames,\n            buttonDisabled: !canUseNames\n        });\n\n        return (\n            <div >\n                {\n                    namesToShow.map((name, i) => {\n                        const isValid = validNames.indexOf(name) > -1;\n                        const isInvalid = invalidNames.indexOf(name) > -1;\n                        const isLoading = loadingNames.indexOf(name) > -1;\n                        const isLast = i === namesToShow.length - 1;\n                        const inputName = \"Input\" + i;\n                        let isValidLabel = isValid ? { icon: \"check\", \"data-testid\": inputName + \"Valid\" } : null;\n                        if (isInvalid) {\n                            isValidLabel = { icon: \"warning sign\", \"data-testid\": inputName + \"Invalid\", color: \"red\" } as any;\n                        }\n\n                        const removeButton = showDelete ? (\n                            <Icon\n                                data-testid={inputName + \"Delete\"}\n                                style={{ cursor: \"pointer\" }}\n                                name=\"remove\"\n                                className=\"link\"\n                                onClick={() => this.onDeleteClick(i)}\n                            />) : null;\n\n                        return <div key={inputName} className=\"field\">\n                            <Input\n                                labelPosition=\"left corner\"\n                                placeholder=\"BGG Username\"\n                                label={isValidLabel}\n                                input={{\n                                    \"data-testid\": inputName\n                                }\n                                }\n                                icon={removeButton}\n                                loading={isLoading}\n                                value={name}\n                                data-testid={isLoading ? inputName + \"Loading\" : null}\n                                type=\"text\"\n                                autoFocus={isLast}\n                                onChange={(e) => this.onInputChange(e.target.value, i)} />\n                        </div>;\n                    }\n                    )\n                }\n                <div className=\"field\">\n                    <button data-testid=\"AddButton\" onClick={() => this.onAddClick()} className=\"ui basic button tiny\">\n                        <i className=\"icon plus\"></i>\n                        Add a friend\n                </button>\n                </div>\n                <div className=\"field\">\n                    <button data-testid=\"UseNames\"\n                        disabled={!canUseNames}\n                        onClick={this.onUseClick} className=\"ui basic button large\">\n                        {forwardButtonText}\n                    </button>\n                </div>\n            </div >\n        );\n    }\n}\n\n\ninterface Props {\n    // can ask this if user is valid or not\n    userValidator?: (name: string) => Promise<boolean>;\n    onNameSelect?: (names: string[]) => any;\n}\n\ninterface State {\n    shownNames: string[];\n    validNames: string[];\n    invalidNames: string[];\n    loadingNames: string[];\n\n}\n\n\nconst initialState: State = {\n    shownNames: [],\n    validNames: [],\n    invalidNames: [],\n    loadingNames: [],\n};\n\n\nexport default class ValidatingUserInput extends React.Component<Props, State> {\n\n    constructor(props: Props) {\n        super(props);\n        this.onNamesChange = this.onNamesChange.bind(this);\n        this.state = initialState;\n        this.doesNameNeedValidation = this.doesNameNeedValidation.bind(this);\n        this.isNameShown = this.isNameShown.bind(this);\n        this.setNameLoading = this.setNameLoading.bind(this);\n        this.setNameValidity = this.setNameValidity.bind(this);\n    }\n\n\n    private doesNameNeedValidation(name: string): boolean {\n        if (name === \"\" || name === undefined) {\n            return false;\n        }\n        const { validNames, invalidNames, loadingNames } = this.state;\n        const { userValidator } = this.props;\n        if (!userValidator) {\n            console.warn(\"[DEBUG] ValidatingUserInput: No userValidator prop provided\");\n            return false;\n        }\n        return !(validNames.indexOf(name) > -1)\n            && !(invalidNames.indexOf(name) > -1)\n            && !(loadingNames.indexOf(name) > -1);\n    }\n\n    private isNameShown(name: string): boolean {\n        return this.state.shownNames.indexOf(name) > -1;\n    }\n\n    private setNameLoading(name: string, loading: boolean) {\n        console.log(`[DEBUG] ValidatingUserInput: setNameLoading name=${name} loading=${loading}`);\n        if (loading) {\n            this.setState({\n                loadingNames: [...this.state.loadingNames, name]\n            });\n        } else {\n            this.setState({\n                loadingNames: this.state.loadingNames.filter((loadingName) => loadingName !== name)\n            });\n        }\n    }\n\n    private setNameValidity(name: string, isValid: boolean) {\n        console.log(`[DEBUG] ValidatingUserInput: setNameValidity name=${name} isValid=${isValid}`);\n        if (isValid) {\n            this.setState({\n                validNames: [...this.state.validNames, name]\n            });\n        } else {\n            this.setState({\n                invalidNames: [...this.state.invalidNames, name]\n            });\n        }\n    }\n\n    private onNamesChange(names: string[]) {\n        const { doesNameNeedValidation, isNameShown, setNameValidity, setNameLoading } = this;\n        const { userValidator } = this.props;\n        \n        console.log(\"[DEBUG] ValidatingUserInput: onNamesChange called with:\", names);\n\n        this.setState({\n            shownNames: names,\n        });\n        const namesToValidate = names.filter(doesNameNeedValidation);\n        console.log(\"[DEBUG] ValidatingUserInput: Names requiring validation:\", namesToValidate);\n\n        namesToValidate.forEach((name) => {\n            setTimeout(async () => {\n                // things might have changed, so check again if the name is still shown\n                if (isNameShown(name) && doesNameNeedValidation(name)) {\n                    console.log(`[DEBUG] ValidatingUserInput: Starting validation for '${name}'`);\n                    setNameLoading(name, true);\n                    try {\n                        const isValid = await userValidator(name);\n                        console.log(`[DEBUG] ValidatingUserInput: Validator returned ${isValid} for '${name}'`);\n                        setNameValidity(name, isValid);\n                    } catch (e) {\n                        // eslint-disable-next-line no-console\n                        console.error(\"[DEBUG] ValidatingUserInput: Error validating user:\", e);\n                        setNameValidity(name, false);\n                    }\n                    setNameLoading(name, false);\n                }\n                // wait a little with calling validator, to make sure people are done typing.\n            }, 300);\n        });\n    }\n\n    render() {\n        const { validNames, shownNames, loadingNames, invalidNames } = this.state;\n        const { onNameSelect } = this.props;\n        return (\n            <div>\n                <Header as=\"h4\" style={{ marginTop: \"2em\" }}>\n                    Hi {shownNames.length <= 1 ? \"my name is\" : \"our names are\"}\n                </Header>\n                <SelectUserInput\n                    bggNames={shownNames}\n                    validNames={validNames}\n                    invalidNames={invalidNames}\n                    onNameChange={this.onNamesChange}\n                    loadingNames={loadingNames}\n                    onNameSelect={onNameSelect}\n                />\n            </div >\n        );\n    }\n}","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--6-1!./App.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"body > .grid {\\n  height: 100%;\\n}\\n.givenames {\\n  height: 100%;\\n}\\n\\n.givenames .column{\\n  max-width: 400px;\\n}\\ndiv#content{\\n  height:100%;\\n}\\n\\n\\n.main.container{\\n      margin-top:1em;\\n  }\\n\\n\\n.topMenu{\\n  background-color: white;\\n  text-align: center;\\n  padding-top: 5px;\\n  padding-bottom: 10px;\\n}\\n\\n.topselect{\\n  display: inline-block;\\n  \\n}\\n@media (max-width: 600px) {\\n  .main.container{\\n      margin-top:3em;\\n  }\\n\\n  .topMenu{\\n      text-align: center;\\n  }\\n.topselect {\\n  display: block;\\n  \\n}\\n}\\n\\n.logoscript{\\n  font-family: 'Satisfy', cursive;\\n}\\n\\n\\n.touchevents span.topselect .dropdown{\\n  font-size: 1.4em;\\n  margin-bottom: 15px;\\n} \\n\\n.logoHeader{\\n  padding: 1em;\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n"],"sourceRoot":""}